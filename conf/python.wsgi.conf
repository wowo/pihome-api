<VirtualHost *:80>
    ServerName 192.168.254.9
    ServerAlias 127.0.0.1
    ServerAlias 109.196.48.23
    ServerAlias localhost
    ServerAlias sznapka.zapto.org
    ServerAlias pi

    LogLevel info
    CustomLog ${APACHE_LOG_DIR}/python_access.log combined
    ErrorLog ${APACHE_LOG_DIR}/python_error.log

    WSGIDaemonProcess pihome user=pi group=pi threads=5 deadlock-timeout=30
    WSGIScriptAlias /api /var/www/pihome-api/init.wsgi

    <Location /api>
        WSGIProcessGroup pihome
        WSGIApplicationGroup %{GLOBAL}
        WSGIScriptReloading On
    </Location>

    <Directory /var/www/pihome-api/>
        Order deny,allow
        Allow from all
    </Directory>

    WSGIDaemonProcess pithermo user=pi group=pi threads=5
    WSGIScriptAlias /pithermo /var/www/pithermo/init.wsgi

    <Location /pithermo>
        WSGIProcessGroup pithermo
        WSGIApplicationGroup %{GLOBAL}
        WSGIScriptReloading On
    </Location>

    <Directory /var/www/pithermo/>
        Order deny,allow
        Allow from all
    </Directory>

    DocumentRoot /var/www/pihome/
    <Directory /var/www/pihome/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
#       Order allow,deny
#       allow from all

        SetEnvIfNoCase HOST ^sznapka\.zapto\.org\.?(:8080)?$ PROTECTED_HOST
        AuthUserFile /var/www/pihome-api/htpasswd
        AuthType Basic
        AuthName "Password Protected"
        Order Deny,Allow
        Satisfy any
        Deny from all
        Require valid-user
        Allow from env=!PROTECTED_HOST
    </Directory>
</VirtualHost>
